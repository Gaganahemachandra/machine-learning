
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{SparkML - 01 Regression}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    Data Source:
https://archive.ics.uci.edu/ml/datasets/Combined+Cycle+Power+Plant

Features consist of hourly average ambient variables

Temperature (T) in the range 1.81°C and 37.11°C, Ambient Pressure (AP)
in the range 992.89-1033.30 milibar, Relative Humidity (RH) in the range
25.56\% to 100.16\% Exhaust Vacuum (V) in teh range 25.36-81.56 cm Hg
Net hourly electrical energy output (EP) 420.26-495.76 MW The averages
are taken from various sensors located around the plant that record the
ambient variables every second. The variables are given without
normalization.

Dataset Information:

The dataset contains 9568 data points collected from a Combined Cycle
Power Plant over 6 years (2006-2011), when the power plant was set to
work with full load. Features consist of hourly average ambient
variables Temperature (T), Ambient Pressure (AP), Relative Humidity (RH)
and Exhaust Vacuum (V) to predict the net hourly electrical energy
output (EP) of the plant. A combined cycle power plant (CCPP) is
composed of gas turbines (GT), steam turbines (ST) and heat recovery
steam generators. In a CCPP, the electricity is generated by gas and
steam turbines, which are combined in one cycle, and is transferred from
one turbine to another. While the Vacuum is colected from and has effect
on the Steam Turbine, he other three of the ambient variables effect the
GT performance.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{o}{!}ls \PYZhy{}ltr \PYZti{}/Downloads/datasets
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
total 345560
drwxr-xr-x 2 training training      4096 Oct 17  2016 ml-20m
-rw-r--r-- 1 training training 127744095 Mar 24 20:20 stocks.csv
drwxrwxrwx 2 training training      4096 Jun 18 21:08 ml-latest-small
-rw-r--r-- 1 training training 150828752 Sep 13 15:33 creditcard-fraud.csv
drwxrwxr-x 2 training training      4096 Sep 13 20:35 mnist
-rw-rw-r-- 1 training training    133638 Sep 13 21:00 credit.csv
-rw-rw-r-- 1 training training  69055807 Sep 13 21:01 imdb-comments.json
-rw-rw-r-- 1 training training      5107 Sep 13 21:01 iris.csv
-rw-rw-r-- 1 training training     57459 Sep 13 21:01 istanbul-stock.csv
-rw-rw-r-- 1 training training       226 Sep 13 21:01 mobile-sales-data.csv
-rw-rw-r-- 1 training training      2436 Sep 13 21:01 startups.csv
drwxrwxr-x 2 training training      4096 Sep 13 21:01 kaggle-house-prices
-rw-rw-r-- 1 training training   4432265 Sep 13 23:51 Bible.txt
drwxrwxr-x 2 training training      4096 Sep 15 05:58 apple.stackexchange.com
-rw-rw-r-- 1 training training   1543413 Sep 15 06:55 Combined\_Cycle\_Power\_Plant.csv

    \end{Verbatim}

    \section{Load Data}\label{load-data}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{df} \PY{o}{=} \PY{n}{spark}\PY{o}{.}\PY{n}{read}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{option}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{header}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{true}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PYZbs{}
        \PY{o}{.}\PY{n}{option}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{inferSchema}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{true}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/training/Downloads/datasets/Combined\PYZus{}Cycle\PYZus{}Power\PYZus{}Plant.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{df}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
+-----+-----+-------+-----+------+
|   AT|    V|     AP|   RH|    PE|
+-----+-----+-------+-----+------+
|14.96|41.76|1024.07|73.17|463.26|
|25.18|62.96|1020.04|59.08|444.37|
| 5.11| 39.4|1012.16|92.14|488.56|
|20.86|57.32|1010.24|76.64|446.48|
|10.82| 37.5|1009.23|96.62| 473.9|
|26.27|59.44|1012.23|58.77|443.67|
|15.89|43.96|1014.02|75.24|467.35|
| 9.48|44.71|1019.12|66.43|478.42|
|14.64| 45.0|1021.78|41.25|475.98|
|11.74|43.56|1015.14|70.72| 477.5|
|17.99|43.72|1008.64|75.04|453.02|
|20.14|46.93|1014.66|64.22|453.99|
|24.34| 73.5|1011.31|84.15|440.29|
|25.71|58.59|1012.77|61.83|451.28|
|26.19|69.34|1009.48|87.59|433.99|
|21.42|43.79|1015.76|43.08|462.19|
|18.21| 45.0|1022.86|48.84|467.54|
|11.04|41.74| 1022.6|77.51| 477.2|
|14.45|52.75|1023.97|63.59|459.85|
|13.97|38.47|1015.15|55.28| 464.3|
+-----+-----+-------+-----+------+
only showing top 20 rows


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{df}\PY{o}{.}\PY{n}{cache}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}6}]:} DataFrame[AT: double, V: double, AP: double, RH: double, PE: double]
\end{Verbatim}
            
    \section{Convert Spark Dataframe to Pandas
Dataframe}\label{convert-spark-dataframe-to-pandas-dataframe}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{df}\PY{o}{.}\PY{n}{toPandas}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{}Do not run on large dataset}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}9}]:}       AT      V       AP     RH      PE
        0  14.96  41.76  1024.07  73.17  463.26
        1  25.18  62.96  1020.04  59.08  444.37
        2   5.11  39.40  1012.16  92.14  488.56
        3  20.86  57.32  1010.24  76.64  446.48
        4  10.82  37.50  1009.23  96.62  473.90
\end{Verbatim}
            
    \subsection{Verctorize the features}\label{verctorize-the-features}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{feature} \PY{k}{import} \PY{o}{*}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{n}{vectorizer} \PY{o}{=} \PY{n}{VectorAssembler}\PY{p}{(}\PY{p}{)}
         \PY{n}{vectorizer}\PY{o}{.}\PY{n}{setInputCols}\PY{p}{(}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{V}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RH}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{vectorizer}\PY{o}{.}\PY{n}{setOutputCol}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{features}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{df\PYZus{}vect} \PY{o}{=} \PY{n}{vectorizer}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{df}\PY{p}{)}
         \PY{n}{df\PYZus{}vect}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
+-----+-----+-------+-----+------+--------------------+
|   AT|    V|     AP|   RH|    PE|            features|
+-----+-----+-------+-----+------+--------------------+
|14.96|41.76|1024.07|73.17|463.26|[14.96,41.76,1024{\ldots}|
|25.18|62.96|1020.04|59.08|444.37|[25.18,62.96,1020{\ldots}|
| 5.11| 39.4|1012.16|92.14|488.56|[5.11,39.4,1012.1{\ldots}|
|20.86|57.32|1010.24|76.64|446.48|[20.86,57.32,1010{\ldots}|
|10.82| 37.5|1009.23|96.62| 473.9|[10.82,37.5,1009{\ldots}|
|26.27|59.44|1012.23|58.77|443.67|[26.27,59.44,1012{\ldots}|
|15.89|43.96|1014.02|75.24|467.35|[15.89,43.96,1014{\ldots}|
| 9.48|44.71|1019.12|66.43|478.42|[9.48,44.71,1019{\ldots}|
|14.64| 45.0|1021.78|41.25|475.98|[14.64,45.0,1021{\ldots}|
|11.74|43.56|1015.14|70.72| 477.5|[11.74,43.56,1015{\ldots}|
|17.99|43.72|1008.64|75.04|453.02|[17.99,43.72,1008{\ldots}|
|20.14|46.93|1014.66|64.22|453.99|[20.14,46.93,1014{\ldots}|
|24.34| 73.5|1011.31|84.15|440.29|[24.34,73.5,1011{\ldots}|
|25.71|58.59|1012.77|61.83|451.28|[25.71,58.59,1012{\ldots}|
|26.19|69.34|1009.48|87.59|433.99|[26.19,69.34,1009{\ldots}|
|21.42|43.79|1015.76|43.08|462.19|[21.42,43.79,1015{\ldots}|
|18.21| 45.0|1022.86|48.84|467.54|[18.21,45.0,1022{\ldots}|
|11.04|41.74| 1022.6|77.51| 477.2|[11.04,41.74,1022{\ldots}|
|14.45|52.75|1023.97|63.59|459.85|[14.45,52.75,1023{\ldots}|
|13.97|38.47|1015.15|55.28| 464.3|[13.97,38.47,1015{\ldots}|
+-----+-----+-------+-----+------+--------------------+
only showing top 20 rows


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{vectorizer}\PY{o}{.}\PY{n}{explainParams}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
inputCols: input column names. (current: ['AT', 'V', 'AP', 'RH'])
outputCol: output column name. (default: VectorAssembler\_406dae73f80cb9440a18\_\_output)

    \end{Verbatim}

    \subsection{Fit Linear Regression
Model}\label{fit-linear-regression-model}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{regression} \PY{k}{import} \PY{n}{LinearRegression}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{lr} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{lr}\PY{o}{.}\PY{n}{explainParams}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
aggregationDepth: suggested depth for treeAggregate (>= 2). (default: 2)
elasticNetParam: the ElasticNet mixing parameter, in range [0, 1]. For alpha = 0, the penalty is an L2 penalty. For alpha = 1, it is an L1 penalty. (default: 0.0)
featuresCol: features column name. (default: features)
fitIntercept: whether to fit an intercept term. (default: True)
labelCol: label column name. (default: label)
maxIter: max number of iterations (>= 0). (default: 100)
predictionCol: prediction column name. (default: prediction)
regParam: regularization parameter (>= 0). (default: 0.0)
solver: the solver algorithm for optimization. If this is not set or empty, default value is 'auto'. (default: auto)
standardization: whether to standardize the training features before fitting the model. (default: True)
tol: the convergence tolerance for iterative algorithms (>= 0). (default: 1e-06)
weightCol: weight column name. If this is not set or empty, we treat all instance weights as 1.0. (undefined)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{n}{lr}\PY{o}{.}\PY{n}{setLabelCol}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PE}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{lr}\PY{o}{.}\PY{n}{setFeaturesCol}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{features}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{model} \PY{o}{=} \PY{n}{lr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{df\PYZus{}vect}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{n+nb}{type}\PY{p}{(}\PY{n}{model}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}55}]:} pyspark.ml.regression.LinearRegressionModel
\end{Verbatim}
            
    \subsubsection{View model summary}\label{view-model-summary}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R2:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{summary}\PY{o}{.}\PY{n}{r2}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Intercept: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{intercept}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Coefficients}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{coefficients}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
R2: 0.9286835997167648
Intercept:  454.5637357984046 Coefficients [-1.97731604346,-0.234028456499,0.0621277600987,-0.158016554398]

    \end{Verbatim}

    \subsubsection{Predict}\label{predict}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{n}{df\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{df\PYZus{}vect}\PY{p}{)}
         \PY{n}{df\PYZus{}pred}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
+-----+-----+-------+-----+------+--------------------+------------------+
|   AT|    V|     AP|   RH|    PE|            features|        prediction|
+-----+-----+-------+-----+------+--------------------+------------------+
|14.96|41.76|1024.07|73.17|463.26|[14.96,41.76,1024{\ldots}| 467.2711634437306|
|25.18|62.96|1020.04|59.08|444.37|[25.18,62.96,1020{\ldots}|444.07766858004396|
| 5.11| 39.4|1012.16|92.14|488.56|[5.11,39.4,1012.1{\ldots}|483.56251796945776|
|20.86|57.32|1010.24|76.64|446.48|[20.86,57.32,1010{\ldots}| 450.5559716382537|
|10.82| 37.5|1009.23|96.62| 473.9|[10.82,37.5,1009{\ldots}| 471.8267489278455|
|26.27|59.44|1012.23|58.77|443.67|[26.27,59.44,1012{\ldots}| 442.3099415850402|
|15.89|43.96|1014.02|75.24|467.35|[15.89,43.96,1014{\ldots}|463.96591866241715|
| 9.48|44.71|1019.12|66.43|478.42|[9.48,44.71,1019{\ldots}| 478.1739705793852|
|14.64| 45.0|1021.78|41.25|475.98|[14.64,45.0,1021{\ldots}|472.04726822434776|
|11.74|43.56|1015.14|70.72| 477.5|[11.74,43.56,1015{\ldots}| 473.0492095425741|
|17.99|43.72|1008.64|75.04|453.02|[17.99,43.72,1008{\ldots}| 459.5670777622559|
|20.14|46.93|1014.66|64.22|453.99|[20.14,46.93,1014{\ldots}|456.64836515783395|
|24.34| 73.5|1011.31|84.15|440.29|[24.34,73.5,1011{\ldots}| 438.7681037606262|
|25.71|58.59|1012.77|61.83|451.28|[25.71,58.59,1012{\ldots}| 443.1661810913976|
|26.19|69.34|1009.48|87.59|433.99|[26.19,69.34,1009{\ldots}| 435.4263567111474|
|21.42|43.79|1015.76|43.08|462.19|[21.42,43.79,1015{\ldots}| 458.2610604716974|
|18.21| 45.0|1022.86|48.84|467.54|[18.21,45.0,1022{\ldots}|463.85600228221267|
|11.04|41.74| 1022.6|77.51| 477.2|[11.04,41.74,1022{\ldots}| 474.2498032497976|
|14.45|52.75|1023.97|63.59|459.85|[14.45,52.75,1023{\ldots}| 467.2152077040968|
|13.97|38.47|1015.15|55.28| 464.3|[13.97,38.47,1015{\ldots}|472.27139648674444|
+-----+-----+-------+-----+------+--------------------+------------------+
only showing top 20 rows


    \end{Verbatim}

    \subsubsection{Evaluate}\label{evaluate}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{evaluation} \PY{k}{import} \PY{n}{RegressionEvaluator}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{n}{evaluator} \PY{o}{=} \PY{n}{RegressionEvaluator}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{evaluator}\PY{o}{.}\PY{n}{explainParams}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
labelCol: label column name. (default: label)
metricName: metric name in evaluation - one of:
                       rmse - root mean squared error (default)
                       mse - mean squared error
                       r2 - r\^{}2 metric
                       mae - mean absolute error. (default: rmse)
predictionCol: prediction column name. (default: prediction)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{n}{evaluator} \PY{o}{=} \PY{n}{RegressionEvaluator}\PY{p}{(}\PY{n}{labelCol} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{PE}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{predictionCol} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{prediction}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{metricName} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rmse}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{evaluator}\PY{o}{.}\PY{n}{evaluate}\PY{p}{(}\PY{n}{df\PYZus{}pred}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}65}]:} 4.557525128298466
\end{Verbatim}
            
    \subsection{Build a pipeline}\label{build-a-pipeline}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}99}]:} \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{Pipeline}\PY{p}{,} \PY{n}{PipelineModel}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}68}]:} \PY{n}{pipeline} \PY{o}{=} \PY{n}{Pipeline}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{pipeline}\PY{o}{.}\PY{n}{explainParams}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n}{pipeline}\PY{o}{.}\PY{n}{setStages}\PY{p}{(}\PY{p}{[}\PY{n}{vectorizer}\PY{p}{,} \PY{n}{lr}\PY{p}{]}\PY{p}{)}
         \PY{n}{pipelineModel} \PY{o}{=} \PY{n}{pipeline}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{df}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
stages: a list of pipeline stages (undefined)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{pipeline}\PY{o}{.}\PY{n}{getStages}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}44}]:} [VectorAssembler\_4fbf8efe8908beb31164, LinearRegression\_4bf49d4e37c6cf84ec09]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}75}]:} \PY{n}{lr\PYZus{}model} \PY{o}{=} \PY{n}{pipelineModel}\PY{o}{.}\PY{n}{stages}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{lr\PYZus{}model} \PY{o}{.}\PY{n}{coefficients}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}75}]:} DenseVector([-1.9773, -0.234, 0.0621, -0.158])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}79}]:} \PY{n}{pipelineModel}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
+-----+-----+-------+-----+------+--------------------+------------------+
|   AT|    V|     AP|   RH|    PE|            features|        prediction|
+-----+-----+-------+-----+------+--------------------+------------------+
|14.96|41.76|1024.07|73.17|463.26|[14.96,41.76,1024{\ldots}| 467.2711634437306|
|25.18|62.96|1020.04|59.08|444.37|[25.18,62.96,1020{\ldots}|444.07766858004396|
| 5.11| 39.4|1012.16|92.14|488.56|[5.11,39.4,1012.1{\ldots}|483.56251796945776|
|20.86|57.32|1010.24|76.64|446.48|[20.86,57.32,1010{\ldots}| 450.5559716382537|
|10.82| 37.5|1009.23|96.62| 473.9|[10.82,37.5,1009{\ldots}| 471.8267489278455|
|26.27|59.44|1012.23|58.77|443.67|[26.27,59.44,1012{\ldots}| 442.3099415850402|
|15.89|43.96|1014.02|75.24|467.35|[15.89,43.96,1014{\ldots}|463.96591866241715|
| 9.48|44.71|1019.12|66.43|478.42|[9.48,44.71,1019{\ldots}| 478.1739705793852|
|14.64| 45.0|1021.78|41.25|475.98|[14.64,45.0,1021{\ldots}|472.04726822434776|
|11.74|43.56|1015.14|70.72| 477.5|[11.74,43.56,1015{\ldots}| 473.0492095425741|
|17.99|43.72|1008.64|75.04|453.02|[17.99,43.72,1008{\ldots}| 459.5670777622559|
|20.14|46.93|1014.66|64.22|453.99|[20.14,46.93,1014{\ldots}|456.64836515783395|
|24.34| 73.5|1011.31|84.15|440.29|[24.34,73.5,1011{\ldots}| 438.7681037606262|
|25.71|58.59|1012.77|61.83|451.28|[25.71,58.59,1012{\ldots}| 443.1661810913976|
|26.19|69.34|1009.48|87.59|433.99|[26.19,69.34,1009{\ldots}| 435.4263567111474|
|21.42|43.79|1015.76|43.08|462.19|[21.42,43.79,1015{\ldots}| 458.2610604716974|
|18.21| 45.0|1022.86|48.84|467.54|[18.21,45.0,1022{\ldots}|463.85600228221267|
|11.04|41.74| 1022.6|77.51| 477.2|[11.04,41.74,1022{\ldots}| 474.2498032497976|
|14.45|52.75|1023.97|63.59|459.85|[14.45,52.75,1023{\ldots}| 467.2152077040968|
|13.97|38.47|1015.15|55.28| 464.3|[13.97,38.47,1015{\ldots}|472.27139648674444|
+-----+-----+-------+-----+------+--------------------+------------------+
only showing top 20 rows


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{n}{evaluator}\PY{o}{.}\PY{n}{evaluate}\PY{p}{(}\PY{n}{pipelineModel}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}81}]:} 4.557525128298466
\end{Verbatim}
            
    \subsection{Save the pipeline to disk to persist the
model}\label{save-the-pipeline-to-disk-to-persist-the-model}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}98}]:} \PY{n}{pipelineModel}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lr\PYZhy{}pipeline}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \subsubsection{Load the persisted model from the
disk}\label{load-the-persisted-model-from-the-disk}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}106}]:} \PY{n}{saved\PYZus{}model} \PY{o}{=} \PY{n}{PipelineModel}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lr\PYZhy{}pipeline}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{saved\PYZus{}model}\PY{o}{.}\PY{n}{stages}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{coefficients}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}106}]:} DenseVector([-1.9773, -0.234, 0.0621, -0.158])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}108}]:} \PY{n}{saved\PYZus{}model}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
+-----+-----+-------+-----+------+--------------------+------------------+
|   AT|    V|     AP|   RH|    PE|            features|        prediction|
+-----+-----+-------+-----+------+--------------------+------------------+
|14.96|41.76|1024.07|73.17|463.26|[14.96,41.76,1024{\ldots}| 467.2711634437306|
|25.18|62.96|1020.04|59.08|444.37|[25.18,62.96,1020{\ldots}|444.07766858004396|
| 5.11| 39.4|1012.16|92.14|488.56|[5.11,39.4,1012.1{\ldots}|483.56251796945776|
|20.86|57.32|1010.24|76.64|446.48|[20.86,57.32,1010{\ldots}| 450.5559716382537|
|10.82| 37.5|1009.23|96.62| 473.9|[10.82,37.5,1009{\ldots}| 471.8267489278455|
|26.27|59.44|1012.23|58.77|443.67|[26.27,59.44,1012{\ldots}| 442.3099415850402|
|15.89|43.96|1014.02|75.24|467.35|[15.89,43.96,1014{\ldots}|463.96591866241715|
| 9.48|44.71|1019.12|66.43|478.42|[9.48,44.71,1019{\ldots}| 478.1739705793852|
|14.64| 45.0|1021.78|41.25|475.98|[14.64,45.0,1021{\ldots}|472.04726822434776|
|11.74|43.56|1015.14|70.72| 477.5|[11.74,43.56,1015{\ldots}| 473.0492095425741|
|17.99|43.72|1008.64|75.04|453.02|[17.99,43.72,1008{\ldots}| 459.5670777622559|
|20.14|46.93|1014.66|64.22|453.99|[20.14,46.93,1014{\ldots}|456.64836515783395|
|24.34| 73.5|1011.31|84.15|440.29|[24.34,73.5,1011{\ldots}| 438.7681037606262|
|25.71|58.59|1012.77|61.83|451.28|[25.71,58.59,1012{\ldots}| 443.1661810913976|
|26.19|69.34|1009.48|87.59|433.99|[26.19,69.34,1009{\ldots}| 435.4263567111474|
|21.42|43.79|1015.76|43.08|462.19|[21.42,43.79,1015{\ldots}| 458.2610604716974|
|18.21| 45.0|1022.86|48.84|467.54|[18.21,45.0,1022{\ldots}|463.85600228221267|
|11.04|41.74| 1022.6|77.51| 477.2|[11.04,41.74,1022{\ldots}| 474.2498032497976|
|14.45|52.75|1023.97|63.59|459.85|[14.45,52.75,1023{\ldots}| 467.2152077040968|
|13.97|38.47|1015.15|55.28| 464.3|[13.97,38.47,1015{\ldots}|472.27139648674444|
+-----+-----+-------+-----+------+--------------------+------------------+
only showing top 20 rows


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}110}]:} \PY{n}{df\PYZus{}train}\PY{p}{,} \PY{n}{df\PYZus{}test} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{randomSplit}\PY{p}{(}\PY{n}{weights}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.7}\PY{p}{,} \PY{l+m+mf}{0.3}\PY{p}{]}\PY{p}{,} \PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}112}]:} \PY{n}{pipelineModel} \PY{o}{=} \PY{n}{pipeline}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{df\PYZus{}train}\PY{p}{)}
          \PY{n}{evaluator}\PY{o}{.}\PY{n}{evaluate}\PY{p}{(}\PY{n}{pipelineModel}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{df\PYZus{}test}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}112}]:} 4.563138184940591
\end{Verbatim}
            
    \section{Tune the model}\label{tune-the-model}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}115}]:} \PY{k+kn}{from} \PY{n+nn}{pyspark}\PY{n+nn}{.}\PY{n+nn}{ml}\PY{n+nn}{.}\PY{n+nn}{tuning} \PY{k}{import} \PY{n}{ParamGridBuilder}\PY{p}{,} \PY{n}{TrainValidationSplit}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}119}]:} \PY{n}{paramGrid} \PY{o}{=} \PY{n}{ParamGridBuilder}\PY{p}{(}\PY{p}{)}\PYZbs{}
              \PY{o}{.}\PY{n}{addGrid}\PY{p}{(}\PY{n}{lr}\PY{o}{.}\PY{n}{regParam}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.01}\PY{p}{]}\PY{p}{)} \PYZbs{}
              \PY{o}{.}\PY{n}{addGrid}\PY{p}{(}\PY{n}{lr}\PY{o}{.}\PY{n}{fitIntercept}\PY{p}{,} \PY{p}{[}\PY{k+kc}{False}\PY{p}{,} \PY{k+kc}{True}\PY{p}{]}\PY{p}{)}\PYZbs{}
              \PY{o}{.}\PY{n}{addGrid}\PY{p}{(}\PY{n}{lr}\PY{o}{.}\PY{n}{elasticNetParam}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}\PYZbs{}
              \PY{o}{.}\PY{n}{build}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} In this case the estimator is simply the linear regression.}
          \PY{c+c1}{\PYZsh{} A TrainValidationSplit requires an Estimator, a set of Estimator ParamMaps, and an Evaluator.}
          \PY{n}{tvs} \PY{o}{=} \PY{n}{TrainValidationSplit}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{lr}\PY{p}{,}
                                     \PY{n}{estimatorParamMaps}\PY{o}{=}\PY{n}{paramGrid}\PY{p}{,}
                                     \PY{n}{evaluator}\PY{o}{=}\PY{n}{evaluator}\PY{p}{,}
                                     \PY{n}{trainRatio}\PY{o}{=}\PY{l+m+mf}{0.8}\PY{p}{)}
          
          \PY{n}{tuned\PYZus{}model} \PY{o}{=} \PY{n}{tvs}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{vectorizer}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{df\PYZus{}train}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}138}]:} \PY{n}{tuned\PYZus{}model}\PY{o}{.}\PY{n}{bestModel}\PY{p}{,} \PY{n}{tuned\PYZus{}model}\PY{o}{.}\PY{n}{validationMetrics}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}138}]:} (LinearRegression\_4bf49d4e37c6cf84ec09,
           [5.039347932903683,
            5.636217630762049,
            5.107247882789134,
            4.547646522666319,
            4.545696090598205,
            4.545352062329218,
            5.038546732463139,
            5.49137539732243,
            5.628475999107409,
            4.545755899303294,
            4.5455883701354445,
            4.545438239526134])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}125}]:} \PY{n}{df\PYZus{}test\PYZus{}pred} \PY{o}{=} \PY{n}{tuned\PYZus{}model}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{vectorizer}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{df\PYZus{}test}\PY{p}{)}\PY{p}{)}
          \PY{n}{df\PYZus{}test\PYZus{}pred}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
+----+-----+-------+-----+------+--------------------+------------------+
|  AT|    V|     AP|   RH|    PE|            features|        prediction|
+----+-----+-------+-----+------+--------------------+------------------+
|1.81|39.42|1026.92|76.97|490.55|[1.81,39.42,1026{\ldots}| 492.8349077427656|
|1.81|39.42|1026.92|76.97|490.55|[1.81,39.42,1026{\ldots}| 492.8349077427656|
|1.81|39.42|1026.92|76.97|490.55|[1.81,39.42,1026{\ldots}| 492.8349077427656|
|1.81|39.42|1026.92|76.97|490.55|[1.81,39.42,1026{\ldots}| 492.8349077427656|
|2.34|39.42|1028.47|69.68|490.34|[2.34,39.42,1028{\ldots}|492.94214880761615|
|2.58|39.42|1028.68|69.03|488.69|[2.58,39.42,1028{\ldots}|492.58206703142434|
|2.58|39.42|1028.68|69.03|488.69|[2.58,39.42,1028{\ldots}|492.58206703142434|
| 2.8|39.64|1011.01|82.96|482.66|[2.8,39.64,1011.0{\ldots}| 489.0569119382538|
| 2.8|39.64|1011.01|82.96|482.66|[2.8,39.64,1011.0{\ldots}| 489.0569119382538|
|3.21|38.44| 1016.9|86.34|491.35|[3.21,38.44,1016{\ldots}| 488.4152185498315|
|3.21|38.44|1017.11|84.86|492.93|[3.21,38.44,1017{\ldots}| 488.6394965835994|
|3.26|41.31| 996.32|100.0|489.38|[3.26,41.31,996.3{\ldots}| 484.4525561174197|
|3.26|41.31| 996.32|100.0|489.38|[3.26,41.31,996.3{\ldots}| 484.4525561174197|
|3.31|39.42|1024.05|84.31|487.19|[3.31,39.42,1024{\ldots}| 488.7036922378125|
|3.31|39.42|1024.05|84.31|487.19|[3.31,39.42,1024{\ldots}| 488.7036922378125|
|3.38|39.64| 1011.0|81.22|488.92|[3.38,39.64,1011{\ldots}| 488.1800909364742|
|3.38|41.31| 998.79|97.76|489.11|[3.38,41.31,998.7{\ldots}| 484.6874147567333|
|3.38|41.31| 998.79|97.76|489.11|[3.38,41.31,998.7{\ldots}| 484.6874147567333|
| 3.4|39.64| 1011.1|83.43|459.86|[3.4,39.64,1011.1{\ldots}| 487.8310275292321|
| 3.4|39.64| 1011.1|83.43|459.86|[3.4,39.64,1011.1{\ldots}| 487.8310275292321|
+----+-----+-------+-----+------+--------------------+------------------+
only showing top 20 rows


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}126}]:} \PY{n}{evaluator}\PY{o}{.}\PY{n}{evaluate}\PY{p}{(}\PY{n}{df\PYZus{}test\PYZus{}pred}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}126}]:} 4.5683171800255895
\end{Verbatim}
            

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
